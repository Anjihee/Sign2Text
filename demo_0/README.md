## 현재 상황 요약 및 수정 내역 보고

---

### 1. 초기 구조
- **버퍼**: `deque(maxlen=10)`  
- **예측 트리거**: 시퀀스 길이 10 도달 시 자동 실행  
- **한계**  
  - 동작 길이가 10프레임에 정확히 맞지 않으면 핵심 구간을 놓침  
  - 모델 예측이 일정 간격 없이 반복 호출되어 불안정  

---

### 2. 수정 내역 및 각 단계별 이유

| 단계             | 수정 사항                                                       | 수정 이유                                                                                 |
| ---------------- | --------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| **버퍼구조 확장**   | `deque(maxlen=10)` → `deque()`                                   | 전체 동작을 저장해 두고, 후처리 단계에서 최적 구간을 자유롭게 추출하기 위함               |
| **수집 토글 기능**  | `s` 키로 `collecting` 플래그 토글                                 | 사용자가 “수집 시작/중지” 시점을 명확히 제어하여 불필요한 프레임 누적을 방지               |
| **예측 트리거 변경** | 자동 예측 제거 → `p` 키 입력 시 예측 실행                          | 예측 시점을 사용자가 직접 결정하게 하여, 동작이 완전히 끝난 시점에만 모델을 호출하기 위함 |
| **슬라이딩 윈도우**  | 단일 10프레임 입력 → 시퀀스 전체에서 연속된 10프레임 구간을 모두 생성 | 동작 중 가장 정보가 풍부한 10프레임 구간을 자동으로 찾기 위해                             |
| **배치 예측 도입**   | 반복 호출 → `np.stack` 으로 윈도우 묶음 생성 후 `model.predict` 한 번만 호출 | 호출 횟수와 오버헤드를 줄여 예측 속도 및 안정성을 확보                                   |
| **버퍼 초기화**    | 예측 후 앞절반 삭제 → `sequence.clear()` 전부 초기화               | 이전 동작 데이터가 다음 예측에 잔류하여 방해하지 않도록 완전 초기화                       |
| **UI 통합·경량화**  | macOS용 폰트·디버그 로직 제거 → Windows `malgun.ttf`, `draw_text`로 통합 | 코드 일관성 유지 및 불필요한 의존성·디버그 로직 제거                                     |

---

### 3. 도입 효과
- **유연한 동작 길이 처리**  
  동작 길이가 5~20프레임 사이 어디든 저장한 뒤, 핵심 10프레임 구간만 골라 예측 가능  
- **예측 안정성 강화**  
  배치 예측으로 반복 호출에 따른 네이티브 충돌 가능성 감소  
- **명확한 제어 흐름**  
  `s`/`p`/`q` 키만으로 수집·예측·종료를 직관적으로 수행  

---

### 4. 현재 한계 및 대응 방안
- **오분류 지속**: 모델이 특정 클래스(“입원”)로 편향 예측  
  - **원인**: 학습 데이터 편향 또는 피처(상대좌표·각도) 한계  
- **권장 조치**  
  1. 데이터셋에 다양한 사용자·속도·동작 추가 수집 후 재학습  
  2. 속도·가속도 등 추가 피처 도입 검토  
  3. 윈도우 크기(8, 12, 15프레임 등) 실험을 통한 최적값 탐색  
